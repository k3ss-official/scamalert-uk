<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChadCan.Help - Ultimate Scam Intelligence Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
</head>
<body class="bg-gray-50">
    <!-- Emergency 159 Banner -->
    <div class="emergency-banner text-white text-center py-3 font-bold text-lg">
        <i class="fas fa-exclamation-triangle mr-2"></i>
        DON'T WASTE TIME - DIAL 159 IF UNSURE ABOUT ANY BANK CALL
        <i class="fas fa-exclamation-triangle ml-2"></i>
    </div>

    <!-- Header -->
    <header class="bg-white shadow-lg">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="bg-blue-600 text-white rounded-full w-12 h-12 flex items-center justify-center">
                        <i class="fas fa-shield-alt text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-800">ChadCan.Help</h1>
                        <p class="text-sm text-gray-600">UK Scam Intelligence Platform</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="text-right">
                        <div class="text-sm text-gray-600">Live Threat Level</div>
                        <div class="flex items-center">
                            <span class="w-3 h-3 bg-red-500 rounded-full threat-pulse mr-2"></span>
                            <span class="font-bold text-red-600">HIGH</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero-gradient text-white py-16">
        <div class="container mx-auto px-6 text-center">
            <h2 class="text-4xl md:text-6xl font-bold mb-6">Stop Scams Before They Stop You</h2>
            <p class="text-xl mb-8 opacity-90">Real-time threat intelligence ‚Ä¢ AI-powered detection ‚Ä¢ Instant protection</p>
            
            <!-- Live Threat Counters -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-8">
                <div class="bg-white bg-opacity-20 rounded-lg p-4 counter-animate">
                    <div class="text-3xl font-bold" id="scamsToday">2,847</div>
                    <div class="text-sm opacity-80">Scams Today</div>
                </div>
                <div class="bg-white bg-opacity-20 rounded-lg p-4 counter-animate">
                    <div class="text-3xl font-bold" id="moneyLost">¬£847k</div>
                    <div class="text-sm opacity-80">Lost This Week</div>
                </div>
                <div class="bg-white bg-opacity-20 rounded-lg p-4 counter-animate">
                    <div class="text-3xl font-bold" id="usersProtected">12,439</div>
                    <div class="text-sm opacity-80">Users Protected</div>
                </div>
                <div class="bg-white bg-opacity-20 rounded-lg p-4 counter-animate">
                    <div class="text-3xl font-bold" id="activeThreats">34</div>
                    <div class="text-sm opacity-80">Active Threats</div>
                </div>
            </div>

            <!-- Main CTA -->
            <button class="bg-white text-blue-600 font-bold py-4 px-8 rounded-full text-xl hover:bg-gray-100 transition-all duration-300 shadow-lg" onclick="openChat()">
                <i class="fas fa-robot mr-2"></i>
                Think You've Been Scammed? Just Ask Chad
            </button>
        </div>
    </section>

    <!-- Scam Detection Center -->
    <section class="py-16 bg-white">
        <div class="container mx-auto px-6">
            <h3 class="text-3xl font-bold text-center mb-12">Scam Detection Center</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Romance Scams -->
                <div class="scam-card bg-white rounded-lg p-6 border shadow-lg hover:shadow-xl transition-shadow cursor-pointer" onclick="openChatWithContext('romance')">
                    <div class="text-4xl mb-4">üíî</div>
                    <h4 class="text-xl font-bold mb-2">Romance Scams</h4>
                    <p class="text-gray-600 mb-4">¬£92M lost in 2024. Targeting lonely hearts with fake relationships.</p>
                    <div class="flex justify-between items-center">
                        <span class="bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-medium">Critical Risk</span>
                        <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700" onclick="event.stopPropagation(); openChatWithContext('romance')">
                            Ask Chad <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>
                </div>

                <!-- Facebook Marketplace -->
                <div class="scam-card bg-white rounded-lg p-6 border shadow-lg hover:shadow-xl transition-shadow cursor-pointer" onclick="openChatWithContext('marketplace')">
                    <div class="text-4xl mb-4">üõí</div>
                    <h4 class="text-xl font-bold mb-2">Facebook Marketplace</h4>
                    <p class="text-gray-600 mb-4">73% of purchase fraud. 34% of listings may be fake.</p>
                    <div class="flex justify-between items-center">
                        <span class="bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-medium">Critical Risk</span>
                        <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700" onclick="event.stopPropagation(); openChatWithContext('marketplace')">
                            Ask Chad <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>
                </div>

                <!-- Fake Parcel Tracking -->
                <div class="scam-card bg-white rounded-lg p-6 border shadow-lg hover:shadow-xl transition-shadow cursor-pointer" onclick="openChatWithContext('parcel')">
                    <div class="text-4xl mb-4">üì¶</div>
                    <h4 class="text-xl font-bold mb-2">Fake Parcel Tracking</h4>
                    <p class="text-gray-600 mb-4">Royal Mail, DPD, Hermes impersonation with fake customs fees.</p>
                    <div class="flex justify-between items-center">
                        <span class="bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm font-medium">High Risk</span>
                        <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700" onclick="event.stopPropagation(); openChatWithContext('parcel')">
                            Ask Chad <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>
                </div>

                <!-- Crypto Investment -->
                <div class="scam-card bg-white rounded-lg p-6 border shadow-lg hover:shadow-xl transition-shadow cursor-pointer" onclick="openChatWithContext('crypto')">
                    <div class="text-4xl mb-4">‚Çø</div>
                    <h4 class="text-xl font-bold mb-2">Fake Crypto Investment</h4>
                    <p class="text-gray-600 mb-4">¬£35M stolen via deepfake celebrity endorsements.</p>
                    <div class="flex justify-between items-center">
                        <span class="bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-medium">Critical Risk</span>
                        <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700" onclick="event.stopPropagation(); openChatWithContext('crypto')">
                            Ask Chad <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>
                </div>

                <!-- Tech Support -->
                <div class="scam-card bg-white rounded-lg p-6 border shadow-lg hover:shadow-xl transition-shadow cursor-pointer" onclick="openChatWithContext('tech_support')">
                    <div class="text-4xl mb-4">üíª</div>
                    <h4 class="text-xl font-bold mb-2">Tech Support Scams</h4>
                    <p class="text-gray-600 mb-4">AnyDesk/TeamViewer remote access targeting elderly users.</p>
                    <div class="flex justify-between items-center">
                        <span class="bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm font-medium">High Risk</span>
                        <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700" onclick="event.stopPropagation(); openChatWithContext('tech_support')">
                            Ask Chad <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>
                </div>

                <!-- Customs/HMRC -->
                <div class="scam-card bg-white rounded-lg p-6 border shadow-lg hover:shadow-xl transition-shadow cursor-pointer" onclick="openChatWithContext('customs')">
                    <div class="text-4xl mb-4">üèõÔ∏è</div>
                    <h4 class="text-xl font-bold mb-2">Fake Customs/HMRC</h4>
                    <p class="text-gray-600 mb-4">Fake government fees and tax refund scams.</p>
                    <div class="flex justify-between items-center">
                        <span class="bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm font-medium">High Risk</span>
                        <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700" onclick="event.stopPropagation(); openChatWithContext('customs')">
                            Ask Chad <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Chat Modal -->
    <div id="chatModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4" style="display: none;">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-lg flex flex-col max-h-[80vh]">
            <!-- Header -->
            <div class="bg-blue-600 text-white p-4 rounded-t-lg flex justify-between items-center">
                <h2 class="text-xl font-semibold">Chat with Chad</h2>
                <div class="flex items-center space-x-4">
                    <div class="text-sm">Time Left: <span id="timerDisplay" class="font-bold">10:00</span></div>
                    <button onclick="closeChat()" class="text-white hover:text-gray-200">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <!-- Messages Area -->
            <div id="chatMessages" class="flex-grow p-4 space-y-4 overflow-y-auto" style="height: 400px;">
                <!-- Messages will be added here -->
            </div>
            
            <!-- Input Area -->
            <div class="border-t p-4 bg-gray-50 rounded-b-lg">
                <div class="flex space-x-2">
                    <input type="text" id="messageInput" class="flex-grow border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Type your message..." onkeypress="if(event.key==='Enter') sendMessage()">
                    <button onclick="sendMessage()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg">
                        Send
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8">
        <div class="container mx-auto px-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <h4 class="text-lg font-semibold mb-4">Emergency Contacts</h4>
                    <p><strong>Dial 159:</strong> Connect to your bank safely</p>
                    <p><strong>Action Fraud:</strong> 0300 123 2040</p>
                    <p><strong>Emergency:</strong> 999</p>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">Report Scams</h4>
                    <p>actionfraud.police.uk</p>
                    <p>HMRC Phishing: <a href="mailto:phishing@hmrc.gov.uk" class="text-blue-400">phishing@hmrc.gov.uk</a></p>
                    <p>Text: Forward to 7726</p>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">Data Protection</h4>
                    <p>‚úì Session-only processing</p>
                    <p>‚úì No permanent storage</p>
                    <p>‚úì GDPR compliant</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="js/chad.js"></script>
    
    <script>
        // Simple chat functionality
        let chatContext = 'general';
        let userLocation = null;
        let freeTimeLeft = 600;
        let timerInterval;
        let chatHistory = [];

        // Get user location on page load
        async function getUserLocation() {
            try {
                const response = await fetch('https://ipapi.co/json/');
                const data = await response.json();
                if (data.city) {
                    userLocation = {
                        city: data.city,
                        region: data.region,
                        country: data.country_name
                    };
                }
            } catch (error) {
                console.log('Could not get location:', error);
            }
        }

        // Generate location-based greeting
        function getLocationGreeting() {
            if (!userLocation) return '';
            
            const greetings = [
                `Hey, I see you're in ${userLocation.city} - my boss is from there too! `,
                `Nice to meet someone from ${userLocation.city}! I've helped quite a few people from your area. `,
                `${userLocation.city}, eh? I've been tracking some interesting scam patterns in your region lately. `,
                `Greetings from the digital world to ${userLocation.city}! `,
                `${userLocation.city} - lovely place! I've been monitoring scam activity across the UK and your area's been quite active. `
            ];
            
            return greetings[Math.floor(Math.random() * greetings.length)];
        }

        // Open chat modal
        function openChat() {
            chatContext = 'general';
            document.getElementById('chatModal').style.display = 'flex';
            initializeChat();
            startTimer();
        }

        function openChatWithContext(context) {
            chatContext = context;
            document.getElementById('chatModal').style.display = 'flex';
            initializeChat();
            startTimer();
        }

        // Close chat modal
        function closeChat() {
            document.getElementById('chatModal').style.display = 'none';
            if (timerInterval) clearInterval(timerInterval);
        }

        // Initialize chat with context-aware message
        function initializeChat() {
            const messages = document.getElementById('chatMessages');
            messages.innerHTML = '';
            
            const contextMessages = {
                'romance': 'I notice you clicked on "Romance Scams" - do you think you might have been targeted by someone online who\'s asking for money or seems too good to be true?',
                'marketplace': 'I see you clicked on "Facebook Marketplace Scams" - are you concerned about a seller or buyer you\'ve been dealing with? Maybe someone asking for unusual payment methods?',
                'parcel': 'I notice you clicked on "Fake Parcel Tracking" - have you received a suspicious text or email about a delivery, maybe asking for customs fees?',
                'crypto': 'I see you clicked on "Fake Crypto Investment" - have you seen ads featuring celebrities promoting investment opportunities?',
                'tech_support': 'I notice you clicked on "Tech Support Scams" - have you received unexpected calls about computer problems or been asked to install remote access software?',
                'customs': 'I see you clicked on "Fake Customs/HMRC" - have you received messages asking for payment of customs fees or tax refunds?',
                'general': 'How can I help you today?'
            };

            const locationGreeting = getLocationGreeting();
            const message = `${locationGreeting}Hi there! I'm Chad, your AI scam detection assistant.

I'm here to help you figure out if something suspicious might be a scam. Don't worry about being technical - just type and speak normally with me. Welcome to the AI age!

${contextMessages[chatContext]}`;

            addMessage('chad', message);
        }

        // Add message to chat
        function addMessage(sender, text) {
            const messages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');

            if (sender === 'chad') {
                messageDiv.className = 'flex items-start space-x-3';
                messageDiv.innerHTML = `
                    <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0">
                        <i class="fas fa-robot text-white text-sm"></i>
                    </div>
                    <div class="bg-gray-100 rounded-lg p-3 max-w-xs">
                        <p class="text-gray-800 text-sm whitespace-pre-wrap">${text}</p>
                    </div>
                `;
            } else {
                messageDiv.className = 'flex items-start space-x-3 justify-end';
                messageDiv.innerHTML = `
                    <div class="bg-blue-600 text-white rounded-lg p-3 max-w-xs">
                        <p class="text-sm whitespace-pre-wrap">${text}</p>
                    </div>
                    <div class="w-8 h-8 bg-gray-400 rounded-full flex items-center justify-center flex-shrink-0">
                        <i class="fas fa-user text-white text-sm"></i>
                    </div>
                `;
            }

            messages.appendChild(messageDiv);
            messages.scrollTop = messages.scrollHeight;
        }

        // Send message
        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            addMessage('user', message);
            input.value = '';
            
            // Add typing indicator
            const typingDiv = document.createElement('div');
            typingDiv.className = 'flex items-start space-x-3';
            typingDiv.innerHTML = `
                <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0">
                    <i class="fas fa-robot text-white text-sm"></i>
                </div>
                <div class="bg-gray-100 rounded-lg p-3">
                    <p class="text-gray-600 text-sm">Chad is typing...</p>
                </div>
            `;
            document.getElementById('chatMessages').appendChild(typingDiv);
            
            try {
                chatHistory.push({ role: 'user', content: message });
                
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        message: message,
                        history: chatHistory,
                        options: {
                            systemPrompt: 'You are Chad, an AI scam detection assistant for ChadCan.Help. You help UK users identify and avoid scams. Be friendly, knowledgeable, and helpful. Keep responses concise but informative.',
                            maxTokens: 500,
                            temperature: 0.7
                        }
                    })
                });
                
                typingDiv.remove();
                
                if (!response.ok) {
                    throw new Error('Failed to get response');
                }
                
                const data = await response.json();
                const aiResponse = data.choices[0].message.content;
                
                addMessage('chad', aiResponse);
                chatHistory.push({ role: 'assistant', content: aiResponse });
                
            } catch (error) {
                typingDiv.remove();
                addMessage('chad', 'Sorry, I encountered an error. Please try again.');
            }
        }

        // Timer functionality
        function startTimer() {
            const timerDisplay = document.getElementById('timerDisplay');
            
            timerInterval = setInterval(() => {
                freeTimeLeft--;
                
                const minutes = Math.floor(freeTimeLeft / 60);
                const seconds = freeTimeLeft % 60;
                
                timerDisplay.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                if (freeTimeLeft <= 0) {
                    clearInterval(timerInterval);
                    addMessage('chad', 'Your free session has ended. Thank you for using ChadCan.Help!');
                }
            }, 1000);
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            getUserLocation();
        });
    </script>
</body>
</html>

